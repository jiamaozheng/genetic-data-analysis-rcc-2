# Analysis of Genetic Data 2: Setup

These instructions assume that you have a user or guest account on the
RCC compute cluster, *midway*. If you plan to use a different
computing resource (e.g., another compute cluster, your own laptop),
the steps described here, and in subsequent episodes, will be slightly
different.

### Introduce yourself

Introduce yourself to your neighbors. If you get stuck in any of the
steps of this workshop, ask one your peers for help before asking the
instructor. Conversely, if you have completed the steps more quickly
than others, consider helping your neighbors.

We may use the University of Chicago
[Google Docs](http://gdocs.uchicago.edu) to share results results and
ask questions as we work through the episodes. Please open up the
[Workshop Google doc](http://tinyurl.com/h46hnm2) in your Web browser
and **introduce yourself**.

### Getting a midway user account

If you do not already have a
[user account on midway](http://rcc.uchicago.edu/getting-started/request-account),
the instructor can provide you with a YubiKey, which will allow you to
access *midway* for the duration of the workshop. (After the workshop,
you can request a proper user account [here](https://rcc.uchicago.edu/getting-started/general-user-account-request) provided you are
associated with Principal Investigator who already has an account.)

To access *midway* with the YubiKey, your username is `rccguestXXXX`,
where `XXXX` is the last 4 digits shown on the Yubikey:

![How to get username from YubiKey](/images/yubikey1.gif)

Whenever a password is requested for this guest account, the (very
long) password is automatically generated by lightly touching the
metal contact:

![How to generate password from YubiKey](/images/yubikey2.gif)

### Connect to midway

Log on to midway using ssh with X forwarding:

```bash
ssh -X username@midway.rcc.uchicago.edu
```

If the `-X` option does not work, run ssh without this option.

Request an **interactive session** using the reservation for this
workshop. To safeguard against losing your connection, I recommend
using **screen**, but this is optional.

```bash
screen -S workshop-gda2
sinteractive --time=02:45:00 --mem=4G --reservation=gda2_rcc_workshop
```

Load the modules necessary to complete the exercises.
  
```bash
module load R/3.2
module load plink/1.90
module load gemma
```

Clone this repository. (Note you don't need a github account to do
this.)

```bash
mkdir -p ~/git
cd ~/git
git clone https://github.com/pcarbo/genetic-data-analysis-rcc-1.git gda1
```

After completing this step, you should have a bunch of new files and
folders in `~/git/gda1`.

If you have a github account, please log in to your account and
bookmark this repository by clicking the "Star" button at the
top-right corner of this webpage.

Copy the data files into the "data" folder in the repository. The data
files take about 350 MB of space, so make sure you have enough space
left over in your home directory for these files. (Run the `quota`
command to check.)

```bash
cd ~/git/gda1/data
cp /project/rcc/workshops/genetic-data-analysis-1/data/* .
```

Running ADMIXTURE ([Episode 4](04-admixture.md)) may take longer than
2 hours to complete, so we have pre-generated the ADMIXTURE
results. Copy these results files into the results folder in the
github repo.

```bash
cd ~/git/gda1/results
cp /project/rcc/workshops/genetic-data-analysis-1/results/* .
```

### Set up graphics

Make sure that you can generate and view graphics in R using
[ggplot2](http://ggplot2.org). First, start R,

```bash
cd ~/git/gda1
R --no-save
```

*Optionally*, load [RStudio](https://rstudio.rcc.uchicago.edu) in
your browser. The rest of workshop will assume that you are running R
from the shell, but all the steps should work in RStudio as well.

and once you have loaded the R environment, enter:

```R
source("code/demo.ggplot.R")
```

This should create an oscillating arrangement of multicolour dots. If
this is not working on your computer, and alternative (for the
*midway* cluster only) is [ThinLinc](http://rcc.uchicago.edu/docs/connecting/index.html#connecting-with-thinlinc).

:white_check_mark: Once you have successfully completed all these
steps, you are ready to move on to [Episode 2](02-pca.md).

### Notes

These instructions are adapted from [the Setup for Part 1](https://github.com/pcarbo/genetic-data-analysis-rcc-1/blob/master/episodes/01-setup.md).
