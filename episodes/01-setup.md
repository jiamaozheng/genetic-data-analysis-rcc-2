# Analysis of Genetic Data 2: Setup

These instructions assume that you have a user or guest account on the
RCC compute cluster, *midway*. If you plan to use a different
computing resource (e.g., another compute cluster, your own laptop),
these instructions will be slightly different.

### Introduce yourself

Introduce yourself to your neighbors. If you get stuck, ask one your
peers for help before asking the instructor. Conversely, if you have
completed the steps more quickly than others, consider helping your
neighbors.

We may use the
[University of Chicago Google Docs](http://gdocs.uchicago.edu) to
share results results and ask questions as we work through the
episodes. Please open up the
[Workshop Google doc](http://tinyurl.com/h46hnm2) in your Web browser
and **introduce yourself**.

### Getting a midway user account

If you do not already have a
[user account on midway](http://rcc.uchicago.edu/getting-started/request-account),
the instructor can provide you with a
[YubiKey](https://www.yubico.com/start), which will allow you to
access *midway* for the duration of the workshop. (After the workshop,
you can request a proper user account
[here](https://rcc.uchicago.edu/getting-started/general-user-account-request)
provided you are associated with a Principal Investigator who already
has an RCC account.)

To access *midway* with the YubiKey, your username is `rccguestXXXX`,
where `XXXX` is the last 4 digits shown on the Yubikey:

![How to get username from YubiKey](/images/yubikey1.gif)

Whenever a password is requested for this guest account, the (very
long) password is automatically generated by lightly touching the
metal contact:

![How to generate password from YubiKey](/images/yubikey2.gif)

### Connect to midway

Log on to midway using ssh with X forwarding:

```bash
ssh -X username@midway.rcc.uchicago.edu
```

If the `-X` option does not work, run ssh without this option.

Request an **interactive session** using the reservation for this
workshop. To safeguard against losing your connection, I recommend
using **screen**, but this is optional.

```bash
screen -S workshop-gda2
sinteractive --time=02:45:00 --mem=4G --reservation=gda2_rcc_workshop
```

### Clone git repository

Clone this repository in your home directory. (Note you don't need a
github account to do this.)

```bash
mkdir -p ~/git
cd ~/git
git clone https://github.com/pcarbo/genetic-data-analysis-rcc-2.git gda2
```

After completing this step, you should be able to see new files and
folders in `~/git/gda2`.

If you have a github account, feel free to log in to your account and
bookmark this repository by clicking the "Star" button at the
top-right corner of this webpage.

### Set up graphics

As part of this workshop, we will use R to generate plots from the
data. There are several graphics options on midway.

The recommend approach is to forward graphics from midway to your
laptop using the X Windows system. The `-X` ssh option will activate
graphics forwarding so long as you already have the appropriate
software installed on your laptop. For example, with Mac OS X you will
need to download and install [XQuartz](http://www.xquartz.org).

If this does not work for you, a convenient alternative is to use
ThinLinc. The instructions for using ThinLinc are given
[here](https://rcc.uchicago.edu/docs/connecting/index.html#connecting-with-thinlinc).

A third option is to use [RStudio](https://rstudio.rcc.uchicago.edu)
in your browser. The rest of workshop assumes that you are running R
from the shell, but the same steps should work equally in RStudio.

Before continuing, let's make sure that you can generate and view
graphics in R using [ggplot2](http://ggplot2.org). First, start R,

```bash
cd ~/git/gda2
module load R/3.2
R --no-save
```

Once you entered into the R environment, run:

```R
source("code/demo.ggplot.R")
```

This should create an oscillating arrangement of multicolour dots.

### Load modules

Load the modules necessary to complete the exercises.
  
```bash
module load R/3.2
module load plink/1.90
module load gemma
```

### Download the data

Copy the data files into the "data" folder in the repository. The data
files take about 350 MB of space, so make sure you have enough space
left over in your home directory for these files. (Run the `quota`
command to check.)

```bash
cd ~/git/gda2/data
cp /project/rcc/workshops/genetic-data-analysis-2/data/* .
```

Running ADMIXTURE ([Episode 4](04-admixture.md)) may take longer than
2 hours to complete, so we have pre-generated the ADMIXTURE
results. Copy these results files into the results folder in the
github repo.

```bash
cd ~/git/gda2/results
cp /project/rcc/workshops/genetic-data-analysis-2/results/* .
```

:white_check_mark: Once you have successfully completed all these
steps, you are ready to move on to [Episode 2](02-pca.md).

### Notes

These instructions are adapted from [the Setup for Part 1](https://github.com/pcarbo/genetic-data-analysis-rcc-1/blob/master/episodes/01-setup.md).
